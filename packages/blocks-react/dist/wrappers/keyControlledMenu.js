"use strict";var _extends=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},_createClass=function(){function n(e,o){for(var t=0;t<o.length;t++){var n=o[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,o,t){return o&&n(e.prototype,o),t&&n(e,t),e}}();function _classCallCheck(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,o){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!o||"object"!=typeof o&&"function"!=typeof o?e:o}function _inherits(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function, not "+typeof o);e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),o&&(Object.setPrototypeOf?Object.setPrototypeOf(e,o):e.__proto__=o)}var React=require("react"),PropTypes=require("prop-types");function keyControlledMenu(e){var o=(_inherits(s,React.Component),_createClass(s,[{key:"componentDidUpdate",value:function(e){if(e.options!==this.props.options){for(var o=[],t=0;t<this.props.options.length;t++)o[t]=React.createRef();this.setState({optionsRefs:o})}}},{key:"onSelect",value:function(e,o){o.onClick?o.onClick(e):this.props.onChange&&this.props.onChange(o),this.props.setVisible(!1)}},{key:"onKeyDown",value:function(e){"Tab"===e.key&&this.props.visible?this.props.setVisible(!1):-1<["ArrowDown"," "].indexOf(e.key)&&!this.props.visible?(e.preventDefault(),this.props.open()):(-1<["ArrowDown","ArrowUp","Enter"," "].indexOf(e.key)&&e.preventDefault(),this.moveFocusUsingKey(e.key))}},{key:"onKeyUp",value:function(e,o){-1<["Enter"," "].indexOf(e.key)?this.onSelect(e,o):"Escape"===e.key&&this.props.setVisible(!1)}},{key:"onFocus",value:function(){this.setState({onFocusIdx:-1})}},{key:"moveFocusUsingKey",value:function(e){var o=this;this.setState({onFocusIdx:this.getFocusIndexAfterKeyPress(e)},function(){return o.focusOption(o.state.onFocusIdx)})}},{key:"getFocusIndexAfterKeyPress",value:function(e){if("ArrowDown"===e)return Math.min(this.state.onFocusIdx+1,this.props.options.length-1);if("ArrowUp"===e)return Math.max(this.state.onFocusIdx-1,0);for(var o=0;o<this.props.options.length;o++){var t=this.props.options[o];if(t.text&&t.text[0].toLowerCase()===e)return o}return this.state.onFocusIdx}},{key:"focusOption",value:function(e){if(!(e<0)){var o=this.state.optionsRefs[e].current;if(o)for(var t=0;t<o.childNodes.length;t++){var n=o.childNodes[t];if("function"==typeof n.focus){n.focus();break}}}}},{key:"render",value:function(){return React.createElement(e,_extends({},this.props,{optionsRefs:this.state.optionsRefs,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,onSelect:this.onSelect,onFocus:this.onFocus}))}}]),s);function s(e){_classCallCheck(this,s);for(var o=_possibleConstructorReturn(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,e)),t=[],n=0;n<o.props.options.length;n++)t[n]=React.createRef();return o.state={onFocusIdx:-1,optionsRefs:t},o.onSelect=o.onSelect.bind(o),o.onKeyDown=o.onKeyDown.bind(o),o.onKeyUp=o.onKeyUp.bind(o),o.onFocus=o.onFocus.bind(o),o}return o.propTypes={visible:PropTypes.bool.isRequired,setVisible:PropTypes.func.isRequired,options:PropTypes.arrayOf(PropTypes.shape({text:PropTypes.oneOfType([PropTypes.string,PropTypes.number]),disabled:PropTypes.bool,value:PropTypes.oneOfType([PropTypes.string,PropTypes.number]),href:PropTypes.string,element:PropTypes.node,key:PropTypes.string})),onChange:PropTypes.func},o.defaultProps={options:[],onChange:function(){}},o}module.exports=keyControlledMenu;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndyYXBwZXJzL2tleUNvbnRyb2xsZWRNZW51LmpzeCJdLCJuYW1lcyI6WyJSZWFjdCIsInJlcXVpcmUiLCJQcm9wVHlwZXMiLCJrZXlDb250cm9sbGVkTWVudSIsIldyYXBwZWRDb21wb25lbnQiLCJHZW5lcmljRHJvcGRvd24iLCJfaW5oZXJpdHMiLCJDb21wb25lbnQiLCJfY3JlYXRlQ2xhc3MiLCJrZXkiLCJ2YWx1ZSIsInByZXZQcm9wcyIsIm9wdGlvbnMiLCJ0aGlzIiwicHJvcHMiLCJvcHRpb25zUmVmcyIsImkiLCJsZW5ndGgiLCJjcmVhdGVSZWYiLCJzZXRTdGF0ZSIsImUiLCJvcHRpb24iLCJvbkNsaWNrIiwib25DaGFuZ2UiLCJzZXRWaXNpYmxlIiwidmlzaWJsZSIsImluZGV4T2YiLCJwcmV2ZW50RGVmYXVsdCIsIm9wZW4iLCJtb3ZlRm9jdXNVc2luZ0tleSIsIm9uU2VsZWN0Iiwib25Gb2N1c0lkeCIsImtleU5hbWUiLCJfdGhpczIiLCJnZXRGb2N1c0luZGV4QWZ0ZXJLZXlQcmVzcyIsImZvY3VzT3B0aW9uIiwic3RhdGUiLCJNYXRoIiwibWluIiwibWF4IiwidGV4dCIsInRvTG93ZXJDYXNlIiwiaWR4Iiwib3B0aW9uUmVmIiwiY3VycmVudCIsImNoaWxkTm9kZXMiLCJjaGlsZCIsImZvY3VzIiwiY3JlYXRlRWxlbWVudCIsIl9leHRlbmRzIiwib25LZXlEb3duIiwib25LZXlVcCIsIm9uRm9jdXMiLCJfY2xhc3NDYWxsQ2hlY2siLCJfdGhpcyIsIl9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiwiX19wcm90b19fIiwiT2JqZWN0IiwiZ2V0UHJvdG90eXBlT2YiLCJjYWxsIiwiYmluZCIsInByb3BUeXBlcyIsImJvb2wiLCJpc1JlcXVpcmVkIiwiZnVuYyIsImFycmF5T2YiLCJzaGFwZSIsIm9uZU9mVHlwZSIsInN0cmluZyIsIm51bWJlciIsImRpc2FibGVkIiwiaHJlZiIsImVsZW1lbnQiLCJub2RlIiwiZGVmYXVsdFByb3BzIiwi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QVVrRSxVQUVqQjdDLFNBQVVyQixVQUFVOEQsTUFHdEIzRCxFQUFnQnFFLGFBQWUsQ0FDN0I5RCxRQUFTLEdBQ1RXLFNBQVUsY0FHTGxCLEVBR1RzRSxPQUFPQyxRQUFVekUiLCJmaWxlIjoid3JhcHBlcnMva2V5Q29udHJvbGxlZE1lbnUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBSZWFjdCA9IHJlcXVpcmUoJ3JlYWN0Jyk7XG5jb25zdCBQcm9wVHlwZXMgPSByZXF1aXJlKCdwcm9wLXR5cGVzJyk7XG5cbmZ1bmN0aW9uIGtleUNvbnRyb2xsZWRNZW51KFdyYXBwZWRDb21wb25lbnQpIHtcbiAgY2xhc3MgR2VuZXJpY0Ryb3Bkb3duIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgICAgc3VwZXIocHJvcHMpO1xuXG4gICAgICBjb25zdCBvcHRpb25zUmVmcyA9IFtdO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnByb3BzLm9wdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgb3B0aW9uc1JlZnNbaV0gPSBSZWFjdC5jcmVhdGVSZWYoKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgb25Gb2N1c0lkeDogLTEsXG4gICAgICAgIG9wdGlvbnNSZWZzXG4gICAgICB9O1xuXG4gICAgICB0aGlzLm9uU2VsZWN0ID0gdGhpcy5vblNlbGVjdC5iaW5kKHRoaXMpO1xuICAgICAgdGhpcy5vbktleURvd24gPSB0aGlzLm9uS2V5RG93bi5iaW5kKHRoaXMpO1xuICAgICAgdGhpcy5vbktleVVwID0gdGhpcy5vbktleVVwLmJpbmQodGhpcyk7XG4gICAgICB0aGlzLm9uRm9jdXMgPSB0aGlzLm9uRm9jdXMuYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRVcGRhdGUocHJldlByb3BzKSB7XG4gICAgICBpZiAocHJldlByb3BzLm9wdGlvbnMgIT09IHRoaXMucHJvcHMub3B0aW9ucykge1xuICAgICAgICBjb25zdCBvcHRpb25zUmVmcyA9IFtdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucHJvcHMub3B0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIG9wdGlvbnNSZWZzW2ldID0gUmVhY3QuY3JlYXRlUmVmKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IG9wdGlvbnNSZWZzIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIG9uU2VsZWN0KGUsIG9wdGlvbikge1xuICAgICAgaWYgKG9wdGlvbi5vbkNsaWNrKSB7XG4gICAgICAgIG9wdGlvbi5vbkNsaWNrKGUpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLnByb3BzLm9uQ2hhbmdlKSB7XG4gICAgICAgIHRoaXMucHJvcHMub25DaGFuZ2Uob3B0aW9uKTtcbiAgICAgIH1cbiAgICAgIHRoaXMucHJvcHMuc2V0VmlzaWJsZShmYWxzZSk7XG4gICAgfVxuXG4gICAgb25LZXlEb3duKGUpIHtcbiAgICAgIGlmIChlLmtleSA9PT0gJ1RhYicgJiYgdGhpcy5wcm9wcy52aXNpYmxlKSB7XG4gICAgICAgIHRoaXMucHJvcHMuc2V0VmlzaWJsZShmYWxzZSk7XG4gICAgICB9IGVsc2UgaWYgKFsnQXJyb3dEb3duJywgJyAnXS5pbmRleE9mKGUua2V5KSA+IC0xICYmICF0aGlzLnByb3BzLnZpc2libGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB0aGlzLnByb3BzLm9wZW4oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChbJ0Fycm93RG93bicsICdBcnJvd1VwJywgJ0VudGVyJywgJyAnXS5pbmRleE9mKGUua2V5KSA+IC0xKSBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHRoaXMubW92ZUZvY3VzVXNpbmdLZXkoZS5rZXkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIG9uS2V5VXAoZSwgb3B0aW9uKSB7XG4gICAgICBpZiAoWydFbnRlcicsICcgJ10uaW5kZXhPZihlLmtleSkgPiAtMSkge1xuICAgICAgICB0aGlzLm9uU2VsZWN0KGUsIG9wdGlvbik7XG4gICAgICB9IGVsc2UgaWYgKGUua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICB0aGlzLnByb3BzLnNldFZpc2libGUoZmFsc2UpO1xuICAgICAgfVxuICAgIH1cblxuICAgIG9uRm9jdXMoKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgb25Gb2N1c0lkeDogLTFcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIG1vdmVGb2N1c1VzaW5nS2V5KGtleU5hbWUpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICBvbkZvY3VzSWR4OiB0aGlzLmdldEZvY3VzSW5kZXhBZnRlcktleVByZXNzKGtleU5hbWUpXG4gICAgICB9LCAoKSA9PiB0aGlzLmZvY3VzT3B0aW9uKHRoaXMuc3RhdGUub25Gb2N1c0lkeCkpXG4gICAgfVxuXG4gICAgZ2V0Rm9jdXNJbmRleEFmdGVyS2V5UHJlc3Moa2V5TmFtZSkge1xuICAgICAgaWYgKGtleU5hbWUgPT09ICdBcnJvd0Rvd24nKSByZXR1cm4gTWF0aC5taW4odGhpcy5zdGF0ZS5vbkZvY3VzSWR4ICsgMSwgdGhpcy5wcm9wcy5vcHRpb25zLmxlbmd0aCAtIDEpO1xuICAgICAgaWYgKGtleU5hbWUgPT09ICdBcnJvd1VwJykgcmV0dXJuIE1hdGgubWF4KHRoaXMuc3RhdGUub25Gb2N1c0lkeCAtIDEsIDApO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnByb3BzLm9wdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qgb3B0aW9uID0gdGhpcy5wcm9wcy5vcHRpb25zW2ldO1xuICAgICAgICBpZiAob3B0aW9uLnRleHQgJiYgb3B0aW9uLnRleHRbMF0udG9Mb3dlckNhc2UoKSA9PT0ga2V5TmFtZSkgcmV0dXJuIGk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5zdGF0ZS5vbkZvY3VzSWR4O1xuICAgIH1cblxuICAgIGZvY3VzT3B0aW9uKGlkeCkge1xuICAgICAgaWYgKGlkeCA8IDApIHJldHVybjtcbiAgICAgIGNvbnN0IG9wdGlvblJlZiA9IHRoaXMuc3RhdGUub3B0aW9uc1JlZnNbaWR4XS5jdXJyZW50O1xuICAgICAgaWYgKG9wdGlvblJlZikge1xuICAgICAgICAvLyByZWYgaXMgdG8gdGhlIGxpIGl0ZW0gdGhhdCBjb250YWlucyB0aGUgZHJvcGRvd24gZWxlbWVudHNcbiAgICAgICAgLy8gc2VhcmNoIGZvciBhIGZvY3VzYWJsZSBjaGlsZFxuICAgICAgICAvLyAocGFydGljdWxhcmx5IGltcG9ydGFudCBmb3IgY3VzdG9tIGVsZW1lbnRzKVxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9wdGlvblJlZi5jaGlsZE5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgY29uc3QgY2hpbGQgPSBvcHRpb25SZWYuY2hpbGROb2Rlc1tpXTtcbiAgICAgICAgICBpZiAodHlwZW9mIGNoaWxkLmZvY3VzID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjaGlsZC5mb2N1cygpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgPFdyYXBwZWRDb21wb25lbnRcbiAgICAgICAgICB7Li4udGhpcy5wcm9wc31cbiAgICAgICAgICBvcHRpb25zUmVmcz17dGhpcy5zdGF0ZS5vcHRpb25zUmVmc31cbiAgICAgICAgICBvbktleURvd249e3RoaXMub25LZXlEb3dufVxuICAgICAgICAgIG9uS2V5VXA9e3RoaXMub25LZXlVcH1cbiAgICAgICAgICBvblNlbGVjdD17dGhpcy5vblNlbGVjdH1cbiAgICAgICAgICBvbkZvY3VzPXt0aGlzLm9uRm9jdXN9XG4gICAgICAgIC8+XG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIEdlbmVyaWNEcm9wZG93bi5wcm9wVHlwZXMgPSB7XG4gICAgdmlzaWJsZTogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgICBzZXRWaXNpYmxlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgIG9wdGlvbnM6IFByb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICB0ZXh0OiBQcm9wVHlwZXMub25lT2ZUeXBlKFtcbiAgICAgICAgUHJvcFR5cGVzLnN0cmluZyxcbiAgICAgICAgUHJvcFR5cGVzLm51bWJlclxuICAgICAgXSksXG4gICAgICBkaXNhYmxlZDogUHJvcFR5cGVzLmJvb2wsXG4gICAgICB2YWx1ZTogUHJvcFR5cGVzLm9uZU9mVHlwZShbXG4gICAgICAgIFByb3BUeXBlcy5zdHJpbmcsXG4gICAgICAgIFByb3BUeXBlcy5udW1iZXJcbiAgICAgIF0pLFxuICAgICAgaHJlZjogUHJvcFR5cGVzLnN0cmluZyxcbiAgICAgIGVsZW1lbnQ6IFByb3BUeXBlcy5ub2RlLFxuICAgICAga2V5OiBQcm9wVHlwZXMuc3RyaW5nXG4gICAgfSkpLFxuICAgIG9uQ2hhbmdlOiBQcm9wVHlwZXMuZnVuY1xuICB9O1xuXG4gIEdlbmVyaWNEcm9wZG93bi5kZWZhdWx0UHJvcHMgPSB7XG4gICAgb3B0aW9uczogW10sXG4gICAgb25DaGFuZ2U6ICgpID0+IHt9XG4gIH07XG5cbiAgcmV0dXJuIEdlbmVyaWNEcm9wZG93bjtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBrZXlDb250cm9sbGVkTWVudTtcbiJdfQ==
